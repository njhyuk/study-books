# 코드 정리 구분

코드 정리는 어디서 해야할까? 다음은 잘못된 사례

1. 동작 변경 코드와 함께 코드 정리 내용 넣기
2. 검토하던 사람들이 PR이 너무 길다고 불평
3. 따라서 코드 정리 내용을 분리 후, 동작 변경 PR 앞이나 뒤에 두기
4. 검토하던 사람들이 코드 정리만 담긴 PR에 대해 무슨 의미인지 모르겠다고 불평
5. 다시 1로 돌아가기

* 그러면 코드 정리는 어디서 해야할까?
  * 코드 정리는 별도의 PR로 만들고, 가급적 PR당 몇 개의 코드 정리만 넣자
* 변경을 구분하지 않는 상태에서 다수의 변경을 반영하면?
  * if 문을 변경하는 도중, 이름이 잘못되었다는걸 깨달음
    * 이름을 변경한 후 다시 if 문으로 돌아가기
    * 변경은 변경을 낳는다
  * 코드 정리를 한다는 것은 현미경으로 그림을 보다가, 특정 대상에 초점을 맞추는 것
    * 프로그래밍 동작 변경 : 프로그래밍을 실행하면서 찾아냄
    * 프로그래밍 구조 변경 : 자세히 살펴봐야 관찰 가능
  * 이 시점에는 서로 다른 두가지가 함께 작용하고 있다고 이제 막 인식한 단계
* 공통 흐름을 알아차리는 단계
  * 비슷한 코드끼리 정리하면 설명하는 도우미가 드러남
  * 도우미를 만들면 동작 변경이 쉬워짐
  * 이때엔 프로그램이 체스와 비슷해져서, 게임의 몇 수 앞을 짐작할 수 있음
  * 다만 아직 큰 PR 한 개에 섞여 있음
* 지금 처럼 모든것을 한꺼번에 모아 놓으면 쉽게 엉망이 된다
  * 검토자들을 주저하게 만든다
  * 변경사항을 나누어 별도의 PR을 만들어야 한다
    * 순서가 있는 코드 정리는 PR 한개로 만든다
    * 동작 변경 역시 별도의 PR을 만든다
    * 번갈아가면서 전환할 때마다 새 PR을 연다
* 이렇게 PR을 나눌지 또는 한 개의 PR로 처리할지는 장단점이 있는 선택
  * 포괄적인 PR
    * 전체 그림을 보여주지만, 검토하는 입장에서는 너무 큰 덩어리
  * 작은 PR
    * 소소한 피드백을 유도, 잡초처럼 무시될 수 있음
    * 보통 검토 시간 단축으로 환영 받음
    * 초점이 분명할 수록 PR은 더 빠른 검토를 장려함 
* 검토 절차가 후퇴하는 경우
  * 코드를 느리게 검토하면 더 큰 PR을 만들게 됨
* 코드 정리 PR을 따로 검토하지 않는 시도
  * 대기 시간이 줄어들어, 더욱더 작게 PR을 만들도록 장려함
